"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.sleep = sleep;
exports.within = within;
exports.atleast = atleast;
function sleep(ms, fn) {
    if (!fn) return new Promise(resolve => setTimeout(resolve, ms));else arguments[2] !== undefined ? setTimeout(fn, ms, ...Array.slice.call(arguments, 2)) : setTimeout(fn, ms);
}

function within(t1, t2, task) {
    if (!task) task = t2, t2 = null;

    task = task();

    const timeout = new Promise((_, reject) => {
        setTimeout(reject, t2 || t1, "timeout");
    });

    task = Promise.race([timeout, task]);

    return t2 ? atleast(t1, task) : task;
}

function atleast(ms, task) {
    return Promise.all([task, sleep(ms)]).then(([task]) => task);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJzbGVlcCIsIndpdGhpbiIsImF0bGVhc3QiLCJtcyIsImZuIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiYXJndW1lbnRzIiwidW5kZWZpbmVkIiwiQXJyYXkiLCJzbGljZSIsImNhbGwiLCJ0MSIsInQyIiwidGFzayIsInRpbWVvdXQiLCJfIiwicmVqZWN0IiwicmFjZSIsImFsbCIsInRoZW4iXSwibWFwcGluZ3MiOiI7Ozs7O1FBQWdCQSxLLEdBQUFBLEs7UUFPQUMsTSxHQUFBQSxNO1FBa0JBQyxPLEdBQUFBLE87QUF6QlQsU0FBU0YsS0FBVCxDQUFlRyxFQUFmLEVBQW1CQyxFQUFuQixFQUF1QjtBQUMxQixRQUFHLENBQUNBLEVBQUosRUFBUSxPQUFPLElBQUlDLE9BQUosQ0FBWUMsV0FBV0MsV0FBV0QsT0FBWCxFQUFvQkgsRUFBcEIsQ0FBdkIsQ0FBUCxDQUFSLEtBQ0tLLFVBQVUsQ0FBVixNQUFpQkMsU0FBakIsR0FDQ0YsV0FBV0gsRUFBWCxFQUFlRCxFQUFmLEVBQW1CLEdBQUdPLE1BQU1DLEtBQU4sQ0FBWUMsSUFBWixDQUFpQkosU0FBakIsRUFBNEIsQ0FBNUIsQ0FBdEIsQ0FERCxHQUVDRCxXQUFXSCxFQUFYLEVBQWVELEVBQWYsQ0FGRDtBQUdSOztBQUVNLFNBQVNGLE1BQVQsQ0FBZ0JZLEVBQWhCLEVBQW9CQyxFQUFwQixFQUF3QkMsSUFBeEIsRUFBNkI7QUFDaEMsUUFBRyxDQUFDQSxJQUFKLEVBQ0lBLE9BQU9ELEVBQVAsRUFDQUEsS0FBSyxJQURMOztBQUdKQyxXQUFPQSxNQUFQOztBQUVBLFVBQU1DLFVBQVUsSUFBSVgsT0FBSixDQUNaLENBQUNZLENBQUQsRUFBSUMsTUFBSixLQUFlO0FBQUVYLG1CQUNiVyxNQURhLEVBQ0xKLE1BQU1ELEVBREQsRUFDSyxTQURMO0FBRWYsS0FIVSxDQUFoQjs7QUFNQUUsV0FBT1YsUUFBUWMsSUFBUixDQUFhLENBQUVILE9BQUYsRUFBV0QsSUFBWCxDQUFiLENBQVA7O0FBRUEsV0FBT0QsS0FBS1osUUFBUVcsRUFBUixFQUFZRSxJQUFaLENBQUwsR0FBeUJBLElBQWhDO0FBQ0g7O0FBRU0sU0FBU2IsT0FBVCxDQUFpQkMsRUFBakIsRUFBcUJZLElBQXJCLEVBQTBCO0FBQzdCLFdBQU9WLFFBQ0ZlLEdBREUsQ0FDRSxDQUFFTCxJQUFGLEVBQVFmLE1BQU1HLEVBQU4sQ0FBUixDQURGLEVBRUZrQixJQUZFLENBRUcsQ0FBQyxDQUFDTixJQUFELENBQUQsS0FBWUEsSUFGZixDQUFQO0FBR0giLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gc2xlZXAobXMsIGZuKSB7XG4gICAgaWYoIWZuKSByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG4gICAgZWxzZSBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZFxuICAgICAgICA/IHNldFRpbWVvdXQoZm4sIG1zLCAuLi5BcnJheS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMikpXG4gICAgICAgIDogc2V0VGltZW91dChmbiwgbXMpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3aXRoaW4odDEsIHQyLCB0YXNrKXtcbiAgICBpZighdGFzaylcbiAgICAgICAgdGFzayA9IHQyLFxuICAgICAgICB0MiA9IG51bGxcblxuICAgIHRhc2sgPSB0YXNrKCk7XG5cbiAgICBjb25zdCB0aW1lb3V0ID0gbmV3IFByb21pc2UoXG4gICAgICAgIChfLCByZWplY3QpID0+IHsgc2V0VGltZW91dChcbiAgICAgICAgICAgIHJlamVjdCwgdDIgfHwgdDEsIFwidGltZW91dFwiXG4gICAgICAgICl9XG4gICAgKVxuICAgIFxuICAgIHRhc2sgPSBQcm9taXNlLnJhY2UoWyB0aW1lb3V0LCB0YXNrIF0pXG4gICAgXG4gICAgcmV0dXJuIHQyID8gYXRsZWFzdCh0MSwgdGFzaykgOiB0YXNrO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXRsZWFzdChtcywgdGFzayl7XG4gICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmFsbChbIHRhc2ssIHNsZWVwKG1zKSBdKVxuICAgICAgICAudGhlbigoW3Rhc2tdKSA9PiB0YXNrKTtcbn0iXX0=